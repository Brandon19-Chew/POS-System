{
  "query": "SELECT \n  p.id,\n  p.name,\n  p.sku,\n  bs.currentStock,\n  bs.minimumStock,\n  COALESCE(ROUND(velocity.dailyVelocity, 2), 0) as dailyVelocity,\n  ROUND((bs.currentStock / NULLIF(COALESCE(velocity.dailyVelocity, 0), 0)), 1) as daysOfStock\nFROM products p\nJOIN branchStock bs ON p.id = bs.productId\nLEFT JOIN (\n  SELECT \n    ti.productId,\n    SUM(ti.quantity) / 90 as dailyVelocity\n  FROM transactionItems ti\n  JOIN transactions t ON ti.transactionId = t.id\n  WHERE t.createdAt >= DATE_SUB(NOW(), INTERVAL 90 DAY)\n  GROUP BY ti.productId\n) velocity ON p.id = velocity.productId\nWHERE bs.currentStock <= bs.minimumStock\nORDER BY ROUND((bs.currentStock / NULLIF(COALESCE(velocity.dailyVelocity, 0), 0)), 1) ASC\nLIMIT 5",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway04.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2sQEvvqVy5VUP4n.root --database YpoahsdMJerdq9PLgGzX6b --execute SELECT \n  p.id,\n  p.name,\n  p.sku,\n  bs.currentStock,\n  bs.minimumStock,\n  COALESCE(ROUND(velocity.dailyVelocity, 2), 0) as dailyVelocity,\n  ROUND((bs.currentStock / NULLIF(COALESCE(velocity.dailyVelocity, 0), 0)), 1) as daysOfStock\nFROM products p\nJOIN branchStock bs ON p.id = bs.productId\nLEFT JOIN (\n  SELECT \n    ti.productId,\n    SUM(ti.quantity) / 90 as dailyVelocity\n  FROM transactionItems ti\n  JOIN transactions t ON ti.transactionId = t.id\n  WHERE t.createdAt >= DATE_SUB(NOW(), INTERVAL 90 DAY)\n  GROUP BY ti.productId\n) velocity ON p.id = velocity.productId\nWHERE bs.currentStock <= bs.minimumStock\nORDER BY ROUND((bs.currentStock / NULLIF(COALESCE(velocity.dailyVelocity, 0), 0)), 1) ASC\nLIMIT 5",
  "returncode": 1,
  "logs": [
    "ERROR 1054 (42S22) at line 1: Unknown column 'bs.currentStock' in 'order clause'"
  ]
}